source("lib.R")
# Read in the data
WoodData <-
read.csv(
"/Users/lukas/Library/Mobile Documents/com~apple~CloudDocs/CU Boulder/Spring 2021/Computational Biology/CompBioLabsAndHW/Final_Project/sample_tree_growth_data_with_locations.csv",
stringsAsFactors = F
)
# Checking for NA
if (length(which(is.na(WoodData))) != 0) {
print("NAs found")
NA_index <- which(is.na(WoodData))
}
# Data overview
str(WoodData)
Wood_Data_Im <-
select(WoodData, Sample.tree.ID,
Species,
Year,
Latitude,
Elevation..m.,
Ring.width..mm.,
Stem.diameter..cm.) %>%
arrange(Sample.tree.ID, Year)
View(Wood_Data_Im)
unique(Wood_Data_Im$Year)
length(which(Wood_Data_Im$Year == 1992))
which(Wood_Data_Im$Year == 1992)
for (i in unique(Wood_Data_Im$Year)) {
length(which(Wood_Data_Im$Year == i))
}
for (i in unique(Wood_Data_Im$Year)) {
temp <- length(which(Wood_Data_Im$Year == i))
print(temp)
}
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] == 1992){
print(i)
}
}
}
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
# Read in the data
WoodData <-
read.csv(
"/Users/lukas/Library/Mobile Documents/com~apple~CloudDocs/CU Boulder/Spring 2021/Computational Biology/CompBioLabsAndHW/Final_Project/sample_tree_growth_data_with_locations.csv",
stringsAsFactors = F
)
# Checking for NA
if (length(which(is.na(WoodData))) != 0) {
print("NAs found")
NA_index <- which(is.na(WoodData))
}
# Data overview
str(WoodData)
Wood_Data_Im <-
select(WoodData, Sample.tree.ID,
Species,
Year,
Latitude,
Elevation..m.,
Ring.width..mm.,
Stem.diameter..cm.) %>%
arrange(Sample.tree.ID, Year)
unique(Wood_Data_Im$Year)
for (i in unique(Wood_Data_Im$Year)) {
temp <- length(which(Wood_Data_Im$Year == i))
print(temp)
}
length(which(Wood_Data_Im$Year == 1992))
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
duplicated(Wood_Data_Im)
which(duplicated(Wood_Data_Im) == TRUE)
# Read in the data
WoodData <-
read.csv(
"/Users/lukas/Library/Mobile Documents/com~apple~CloudDocs/CU Boulder/Spring 2021/Computational Biology/CompBioLabsAndHW/Final_Project/sample_tree_growth_data_with_locations.csv",
stringsAsFactors = F
)
# Checking for NA
if (length(which(is.na(WoodData))) != 0) {
print("NAs found")
NA_index <- which(is.na(WoodData))
}
# Data overview
str(WoodData)
Wood_Data_Im <-
select(WoodData, Sample.tree.ID,
Species,
Year,
Latitude,
Elevation..m.,
Ring.width..mm.,
Stem.diameter..cm.) %>%
arrange(Sample.tree.ID, Year)
which(duplicated(Wood_Data_Im) == TRUE)
Wood_Data_Im <- Wood_Data_Im %>% distinct()
which(duplicated(Wood_Data_Im) == TRUE)
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
Wood_Data_Im[9961,]
Wood_Data_Im[9979,]
Wood_Data_Im[9980,]
Wood_Data_Im <- Wood_Data_Im %>% rows_delete(Wood_Data_Im[9961:9979])
Wood_Data_Im <- Wood_Data_Im %>% rows_delete(Wood_Data_Im[9961:9979,])
rows_delete(Wood_Data_Im, Wood_Data_Im[9961:9979,])
Wood_Data_Im <- Wood_Data_Im[-seq(9961,9979)]
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
Wood_Data_Im <- Wood_Data_Im[-1 * seq(9961,9979)]
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
Wood_Data_Im <- Wood_Data_Im[-1 * seq(9961,9979),]
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
setwd("/Users/lukas/Library/Mobile Documents/com~apple~CloudDocs/CU Boulder/Spring 2021/Computational Biology/CompBioLabsAndHW/Final_Project")
require("tidyverse")
library("ggpubr")
library("ggplot2")
library("dplyr")
source("lib.R")
# Read in the data
WoodData <-
read.csv(
"/Users/lukas/Library/Mobile Documents/com~apple~CloudDocs/CU Boulder/Spring 2021/Computational Biology/CompBioLabsAndHW/Final_Project/sample_tree_growth_data_with_locations.csv",
stringsAsFactors = F
)
# Checking for NA
if (length(which(is.na(WoodData))) != 0) {
print("NAs found")
NA_index <- which(is.na(WoodData))
}
# Data overview
str(WoodData)
Wood_Data_Im <-
select(WoodData, Sample.tree.ID,
Species,
Year,
Latitude,
Elevation..m.,
Ring.width..mm.,
Stem.diameter..cm.) %>%
arrange(Sample.tree.ID, Year)
which(duplicated(Wood_Data_Im) == TRUE)
Wood_Data_Im <- Wood_Data_Im %>% distinct()
which(duplicated(Wood_Data_Im) == TRUE)
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
Wood_Data_Im <- Wood_Data_Im[-1 * seq(9961,9979),]
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
unique(Wood_Data_Im$Year)
# Print the names of the five unique species
Species_names <- unique(Wood_Data_Im$Species)
Wood_Data_Growth_Rate <- cbind(Wood_Data_Im, matrix( nrow = dim(Wood_Data_Im)[1], ncol =  2))
colnames(Wood_Data_Growth_Rate) <- c(colnames(Wood_Data_Im), "GrowthRateRing", "GrowthRateStem")
for (i in 1:dim(Wood_Data_Growth_Rate)[1]) {
if(Wood_Data_Growth_Rate$Year[i] == min(Wood_Data_Growth_Rate$Year)){
Wood_Data_Growth_Rate$GrowthRateRing[i] = 0
Wood_Data_Growth_Rate$GrowthRateStem[i] = 0
}else{
Wood_Data_Growth_Rate$GrowthRateRing[i] = (Wood_Data_Growth_Rate$Ring.width..mm.[i] -  Wood_Data_Growth_Rate$Ring.width..mm.[i - 1]) / abs(Wood_Data_Growth_Rate$Ring.width..mm.[i - 1])
Wood_Data_Growth_Rate$GrowthRateStem[i] = (Wood_Data_Growth_Rate$Stem.diameter..cm.[i] - Wood_Data_Growth_Rate$Stem.diameter..cm.[i - 1]) / abs(Wood_Data_Growth_Rate$Stem.diameter..cm.[i - 1])
}
}
con <-  Wood_Data_Growth_Rate$Latitude > 44
Ring_Growth_Lat_over_40 <- Calculate_Growth(con)
con <-  Wood_Data_Growth_Rate$Latitude < 44
Ring_Growth_Lat_under_40 <- Calculate_Growth(con)
p_ring_over_40 <- ggplot(data.frame(Ring_Growth_Lat_over_40), aes(x = Year)) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 2], color = colnames(Ring_Growth_Lat_over_40)[2])) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 3], color = colnames(Ring_Growth_Lat_over_40)[3])) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 4], color = colnames(Ring_Growth_Lat_over_40)[4])) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 5], color = colnames(Ring_Growth_Lat_over_40)[5])) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 6], color = colnames(Ring_Growth_Lat_over_40)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Ring Growth Rate compared by year \n in the North") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
p_ring_under_40 <- ggplot(data.frame(Ring_Growth_Lat_under_40), aes(x = Year)) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 2], color = colnames(Ring_Growth_Lat_under_40)[2])) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 3], color = colnames(Ring_Growth_Lat_under_40)[3])) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 4], color = colnames(Ring_Growth_Lat_under_40)[4])) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 5], color = colnames(Ring_Growth_Lat_under_40)[5])) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 6], color = colnames(Ring_Growth_Lat_under_40)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Ring Growth Rate compared by year \n in the South") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
figure_ring_latitude <- ggarrange(p_ring_under_40,
p_ring_over_40,
labels = c("A", "B"),
ncol = 2,
nrow = 1)
figure_ring_latitude
con <-  Wood_Data_Growth_Rate$Elevation..m. < 2000
Ring_Growth_Ele_under_2000 <- Calculate_Growth(con)
con <-  (Wood_Data_Growth_Rate$Elevation..m. > 2000 &  Wood_Data_Growth_Rate$Elevation..m. < 3000)
Ring_Growth_Ele_over_2000 <- Calculate_Growth(con)
con <-  Wood_Data_Growth_Rate$Elevation..m. > 3000
Ring_Growth_Ele_over_3000 <- Calculate_Growth(con)
p_ring_under_2000 <- ggplot(data.frame(Ring_Growth_Ele_under_2000), aes(x = Year)) +
geom_line(aes(y = Ring_Growth_Ele_under_2000[, 2], color = colnames(Ring_Growth_Ele_under_2000)[2])) +
geom_line(aes(y = Ring_Growth_Ele_under_2000[, 3], color = colnames(Ring_Growth_Ele_under_2000)[3])) +
geom_line(aes(y = Ring_Growth_Ele_under_2000[, 4], color = colnames(Ring_Growth_Ele_under_2000)[4])) +
geom_line(aes(y = Ring_Growth_Ele_under_2000[, 5], color = colnames(Ring_Growth_Ele_under_2000)[5])) +
geom_line(aes(y = Ring_Growth_Ele_under_2000[, 6], color = colnames(Ring_Growth_Ele_under_2000)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Ring Growth Rate compared by year \n under 2000 m") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
p_ring_over_2000 <- ggplot(data.frame(Ring_Growth_Ele_over_2000), aes(x = Year)) +
geom_line(aes(y = Ring_Growth_Ele_over_2000[, 2], color = colnames(Ring_Growth_Ele_over_2000)[2])) +
geom_line(aes(y = Ring_Growth_Ele_over_2000[, 3], color = colnames(Ring_Growth_Ele_over_2000)[3])) +
geom_line(aes(y = Ring_Growth_Ele_over_2000[, 4], color = colnames(Ring_Growth_Ele_over_2000)[4])) +
geom_line(aes(y = Ring_Growth_Ele_over_2000[, 5], color = colnames(Ring_Growth_Ele_over_2000)[5])) +
geom_line(aes(y = Ring_Growth_Ele_over_2000[, 6], color = colnames(Ring_Growth_Ele_over_2000)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Ring Growth Rate of compared by year \n between 2000 m and 3000 m") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
p_ring_over_3000 <- ggplot(data.frame(Ring_Growth_Ele_over_3000), aes(x = Year)) +
geom_line(aes(y = Ring_Growth_Ele_over_3000[, 2], color = colnames(Ring_Growth_Ele_over_3000)[2])) +
geom_line(aes(y = Ring_Growth_Ele_over_3000[, 3], color = colnames(Ring_Growth_Ele_over_3000)[3])) +
geom_line(aes(y = Ring_Growth_Ele_over_3000[, 4], color = colnames(Ring_Growth_Ele_over_3000)[4])) +
geom_line(aes(y = Ring_Growth_Ele_over_3000[, 5], color = colnames(Ring_Growth_Ele_over_3000)[5])) +
geom_line(aes(y = Ring_Growth_Ele_over_3000[, 6], color = colnames(Ring_Growth_Ele_over_3000)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Ring Growth Rate compared by year \n over 3000 m") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
figure_ring_elevation <- ggarrange(p_ring_under_2000,
p_ring_over_2000,
p_ring_over_3000,
labels = c("A", "B", "C"),
ncol = 1,
nrow = 3)
figure_ring_elevation
con <-  Wood_Data_Growth_Rate$Latitude > 40
Stem_Growth_Lat_over_40 <- Calculate_Growth_Stem(con)
con <-  Wood_Data_Growth_Rate$Latitude < 40
Stem_Growth_Lat_under_40 <- Calculate_Growth_Stem(con)
p_stem_over_40 <- ggplot(data.frame(Stem_Growth_Lat_over_40), aes(x = Year)) +
geom_line(aes(y = Stem_Growth_Lat_over_40[, 2], color = colnames(Stem_Growth_Lat_over_40)[2])) +
geom_line(aes(y = Stem_Growth_Lat_over_40[, 3], color = colnames(Stem_Growth_Lat_over_40)[3])) +
geom_line(aes(y = Stem_Growth_Lat_over_40[, 4], color = colnames(Stem_Growth_Lat_over_40)[4])) +
geom_line(aes(y = Stem_Growth_Lat_over_40[, 5], color = colnames(Stem_Growth_Lat_over_40)[5])) +
geom_line(aes(y = Stem_Growth_Lat_over_40[, 6], color = colnames(Stem_Growth_Lat_over_40)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Stem Growth Rate compared by year \n in the North") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
figure_stem_latitude
p_stem_under_40 <- ggplot(data.frame(Stem_Growth_Lat_under_40), aes(x = Year)) +
geom_line(aes(y = Stem_Growth_Lat_under_40[, 2], color = colnames(Stem_Growth_Lat_under_40)[2])) +
geom_line(aes(y = Stem_Growth_Lat_under_40[, 3], color = colnames(Stem_Growth_Lat_under_40)[3])) +
geom_line(aes(y = Stem_Growth_Lat_under_40[, 4], color = colnames(Stem_Growth_Lat_under_40)[4])) +
geom_line(aes(y = Stem_Growth_Lat_under_40[, 5], color = colnames(Stem_Growth_Lat_under_40)[5])) +
geom_line(aes(y = Stem_Growth_Lat_under_40[, 6], color = colnames(Stem_Growth_Lat_under_40)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Stem Growth Rate compared by year \n in the South") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
con <-  Wood_Data_Growth_Rate$Elevation..m. < 2000
Stem_Growth_Ele_under_2000 <- Calculate_Growth_Stem(con)
con <-  (Wood_Data_Growth_Rate$Elevation..m. > 2000 &  Wood_Data_Growth_Rate$Elevation..m. < 3000)
Stem_Growth_Ele_over_2000 <- Calculate_Growth_Stem(con)
con <-  Wood_Data_Growth_Rate$Elevation..m. > 3000
Stem_Growth_Ele_over_3000 <- Calculate_Growth_Stem(con)
p_stem_over_2000 <- ggplot(data.frame(Stem_Growth_Ele_over_2000), aes(x = Year)) +
geom_line(aes(y = Stem_Growth_Ele_over_2000[, 2], color = colnames(Stem_Growth_Ele_over_2000)[2])) +
geom_line(aes(y = Stem_Growth_Ele_over_2000[, 3], color = colnames(Stem_Growth_Ele_over_2000)[3])) +
geom_line(aes(y = Stem_Growth_Ele_over_2000[, 4], color = colnames(Stem_Growth_Ele_over_2000)[4])) +
geom_line(aes(y = Stem_Growth_Ele_over_2000[, 5], color = colnames(Stem_Growth_Ele_over_2000)[5])) +
geom_line(aes(y = Stem_Growth_Ele_over_2000[, 6], color = colnames(Stem_Growth_Ele_over_2000)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Stem Growth Rate compared by year \n between 2000 m and 3000 m") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
figure_stem_latitude <- ggarrange(p_stem_under_40,
p_stem_over_40,
labels = c("A", "B"),
ncol = 2,
nrow = 1)
p_stem_under_2000 <- ggplot(data.frame(Stem_Growth_Ele_under_2000), aes(x = Year)) +
geom_line(aes(y = Stem_Growth_Ele_under_2000[, 2], color = colnames(Stem_Growth_Ele_under_2000)[2])) +
geom_line(aes(y = Stem_Growth_Ele_under_2000[, 3], color = colnames(Stem_Growth_Ele_under_2000)[3])) +
geom_line(aes(y = Stem_Growth_Ele_under_2000[, 4], color = colnames(Stem_Growth_Ele_under_2000)[4])) +
geom_line(aes(y = Stem_Growth_Ele_under_2000[, 5], color = colnames(Stem_Growth_Ele_under_2000)[5])) +
geom_line(aes(y = Stem_Growth_Ele_under_2000[, 6], color = colnames(Stem_Growth_Ele_under_2000)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Stem Growth Rate compared by year \n under 2000 m ") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
p_stem_over_3000 <- ggplot(data.frame(Stem_Growth_Ele_over_3000), aes(x = Year)) +
geom_line(aes(y = Stem_Growth_Ele_over_3000[, 2], color = colnames(Stem_Growth_Ele_over_3000)[2])) +
geom_line(aes(y = Stem_Growth_Ele_over_3000[, 3], color = colnames(Stem_Growth_Ele_over_3000)[3])) +
geom_line(aes(y = Stem_Growth_Ele_over_3000[, 4], color = colnames(Stem_Growth_Ele_over_3000)[4])) +
geom_line(aes(y = Stem_Growth_Ele_over_3000[, 5], color = colnames(Stem_Growth_Ele_over_3000)[5])) +
geom_line(aes(y = Stem_Growth_Ele_over_3000[, 6], color = colnames(Stem_Growth_Ele_over_3000)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Stem Growth Rate compared by year \n over 3000 m") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
figure_stem_elevation <- ggarrange(p_stem_under_2000,
p_stem_over_2000,
p_stem_over_3000,
labels = c("A", "B", "C"),
ncol = 1,
nrow = 3)
figure_stem_elevation
setwd("/Users/lukas/Library/Mobile Documents/com~apple~CloudDocs/CU Boulder/Spring 2021/Computational Biology/CompBioLabsAndHW/Final_Project")
require("tidyverse")
library("ggpubr")
library("ggplot2")
library("dplyr")
source("lib.R")
# Read in the data
WoodData <-
read.csv(
"/Users/lukas/Library/Mobile Documents/com~apple~CloudDocs/CU Boulder/Spring 2021/Computational Biology/CompBioLabsAndHW/Final_Project/sample_tree_growth_data_with_locations.csv",
stringsAsFactors = F
)
# Checking for NA
if (length(which(is.na(WoodData))) != 0) {
print("NAs found")
NA_index <- which(is.na(WoodData))
}
# Data overview
str(WoodData)
Wood_Data_Im <-
select(WoodData, Sample.tree.ID,
Species,
Year,
Latitude,
Elevation..m.,
Ring.width..mm.,
Stem.diameter..cm.) %>%
arrange(Sample.tree.ID, Year)
which(duplicated(Wood_Data_Im) == TRUE)
Wood_Data_Im <- Wood_Data_Im %>% distinct()
which(duplicated(Wood_Data_Im) == TRUE)
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
Wood_Data_Im <- Wood_Data_Im[-1 * seq(9961,9979),]
for (i in 1:length(Wood_Data_Im$Year)) {
if(Wood_Data_Im$Year[i] == 1993){
if(Wood_Data_Im$Year[i - 1] != 1992){
print(i)
}
}
}
unique(Wood_Data_Im$Year)
for (i in unique(Wood_Data_Im$Year)) {
temp <- length(which(Wood_Data_Im$Year == i))
print(temp)
}
length(which(Wood_Data_Im$Year == 1992))
# Print the names of the five unique species
Species_names <- unique(Wood_Data_Im$Species)
Wood_Data_Growth_Rate <- cbind(Wood_Data_Im, matrix( nrow = dim(Wood_Data_Im)[1], ncol =  2))
colnames(Wood_Data_Growth_Rate) <- c(colnames(Wood_Data_Im), "GrowthRateRing", "GrowthRateStem")
for (i in 1:dim(Wood_Data_Growth_Rate)[1]) {
if(Wood_Data_Growth_Rate$Year[i] == min(Wood_Data_Growth_Rate$Year)){
Wood_Data_Growth_Rate$GrowthRateRing[i] = 0
Wood_Data_Growth_Rate$GrowthRateStem[i] = 0
}else{
Wood_Data_Growth_Rate$GrowthRateRing[i] = (Wood_Data_Growth_Rate$Ring.width..mm.[i] -  Wood_Data_Growth_Rate$Ring.width..mm.[i - 1]) / abs(Wood_Data_Growth_Rate$Ring.width..mm.[i - 1])
Wood_Data_Growth_Rate$GrowthRateStem[i] = (Wood_Data_Growth_Rate$Stem.diameter..cm.[i] - Wood_Data_Growth_Rate$Stem.diameter..cm.[i - 1]) / abs(Wood_Data_Growth_Rate$Stem.diameter..cm.[i - 1])
}
}
con <-  Wood_Data_Growth_Rate$Latitude > 44
Ring_Growth_Lat_over_40 <- Calculate_Growth(con)
con <-  Wood_Data_Growth_Rate$Latitude < 44
Ring_Growth_Lat_under_40 <- Calculate_Growth(con)
p_ring_under_40 <- ggplot(data.frame(Ring_Growth_Lat_under_40), aes(x = Year)) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 2], color = colnames(Ring_Growth_Lat_under_40)[2])) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 3], color = colnames(Ring_Growth_Lat_under_40)[3])) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 4], color = colnames(Ring_Growth_Lat_under_40)[4])) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 5], color = colnames(Ring_Growth_Lat_under_40)[5])) +
geom_line(aes(y = Ring_Growth_Lat_under_40[, 6], color = colnames(Ring_Growth_Lat_under_40)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Ring Growth Rate compared by year \n in the South") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
p_ring_over_40 <- ggplot(data.frame(Ring_Growth_Lat_over_40), aes(x = Year)) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 2], color = colnames(Ring_Growth_Lat_over_40)[2])) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 3], color = colnames(Ring_Growth_Lat_over_40)[3])) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 4], color = colnames(Ring_Growth_Lat_over_40)[4])) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 5], color = colnames(Ring_Growth_Lat_over_40)[5])) +
geom_line(aes(y = Ring_Growth_Lat_over_40[, 6], color = colnames(Ring_Growth_Lat_over_40)[6])) +
scale_color_discrete(name = "Species") +
ggtitle("Ring Growth Rate compared by year \n in the North") +
xlab("Year") + ylab("Growth Rate") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
figure_ring_latitude <- ggarrange(p_ring_under_40,
p_ring_over_40,
labels = c("A", "B"),
ncol = 2,
nrow = 1)
figure_ring_latitude
Species_names
temp <- Wood_Data_Growth_Rate[which(Wood_Data_Growth_Rate$Species == Species_names[5])]
temp <- Wood_Data_Growth_Rate[which(Wood_Data_Growth_Rate$Species == Species_names[5]),]
View(temp)
temp <- temp[which(temp$Year == 2002 | temp$Year == 2003), ]
max <- 0
for (i in 2:dim(temp)[1]) {
diff <- temp$Ring.width..mm.[i] - temp$Ring.width..mm.[i - 1]
if(max > abs(diff)){
max <- diff
}
}
max
for (i in 2:dim(temp)[1]) {
diff <- temp$Ring.width..mm.[i] - temp$Ring.width..mm.[i - 1]
print(diff)
}
t <- 0
for (i in 2:dim(temp)[1]) {
diff <- temp$Ring.width..mm.[i] - temp$Ring.width..mm.[i - 1]
t <- t + diff
}
t
temp <- Wood_Data_Growth_Rate[which(Wood_Data_Growth_Rate$Species == Species_names[5]),]
temp <- temp[which(temp$Year == 2002 | temp$Year == 2003), ]
t <- 0
for (i in 2:dim(temp)[1]) {
diff <- temp$Ring.width..mm.[i] - temp$Ring.width..mm.[i - 1]
t <- t + diff
}
t/(dim(temp)[1] / 2)
temp <- Wood_Data_Growth_Rate[which(Wood_Data_Growth_Rate$Species == Species_names[5]),]
temp <- temp[which(temp$Year == 2002 | temp$Year == 2003), ]
for(i in seq(2,dim(temp)[1],2)){
l[i,1] <- (temp$Ring.width..mm.[i] -  temp$Ring.width..mm.[i - 1]) / abs(temp$Ring.width..mm.[i - 1])
}
l <- matrix(nrow =dim(temp)[1],1)
for(i in seq(2,dim(temp)[1],2)){
l[i,1] <- (temp$Ring.width..mm.[i] -  temp$Ring.width..mm.[i - 1]) / abs(temp$Ring.width..mm.[i - 1])
}
View(l)
mean(l)
591 + 114
which(l) > 100
which(l > 100)
114 /2
(1.794 - 0.965) / 0.965
(4.108 - 1.646) /1.646
a<- Wood_Data_Im[which(Wood_Data_Im$Sample.tree.ID == LIN0614121615PP)]
a<- Wood_Data_Im[which(Wood_Data_Im$Sample.tree.ID == "LIN0614121615PP")]
a<- Wood_Data_Im[which(Wood_Data_Im$Sample.tree.ID == "LIN0614121615PP"),]
View(a)
